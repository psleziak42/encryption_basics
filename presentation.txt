It all started with scripture. In Europe majority of people did not know how to read and write untill XV-XX century. In XV century Gutenberg invented printer and this started the age of printing press and made text accessible for general public. But it is estimated that only in XX century over 80% knew how to write and read. But anyway - even in Ancient times there was already a need to hide important messages not only in the pocket, or under the belt, to protect it from being read after messenger was captured by the enemy. And here we introduce:



-> STEGANOGRAPHY - is about HIDING THE MESSAGE.
The first "steganographed" message is dated to be sent in V Century BC by Greek Demaratos. He warned King of Sparta about upcoming war with Persian carving the message on the piece of wood that was covered with wax. This way it reached the destination unnoticed, however it took a while till Leonidas wife figured out that there must be something into it. The rest of the story we know.

Other interesting method used during IIWW by Germans was to hide real message in the "." of another one. How? Well the dot was simply a picture that was decreased to so little size that it looked like a dot. If someone would just take a quick glance on it would probably not notice anything strange. On the other side Germans know what to expect and the message could travel unnoticed for a long time.

Obviously the disadvantage of this method is that once captured, the content is not protected. So even thousand years back in time they asked question: how to HIDE THE CONTENT?



-> CRYPTOGRAPHY - is about HIDING THE CONTENT OF THE MESSAGE, not the message itself.
In ancient times kryptography contained of two types: shifting and/or substituing. Shifting means simply to switch letters in the sentence (it is called anagram). So:

PLAIN TEXT: "coffee"
ANAGRAM: "Eofcef" 

First known device was invented in V BC, and it was called "scytale". It contained of cylinder and a belt wound up on it. Then the message was written on the belt. Now the messenger could wear the belt with the message inside, and the receiver to read it had to have a cylinder with the same or very similar size. 

/zdjecie scytale/

Substituing on another hand was to change letters. The most popular was Cesar's Cypher that changed every letter of a sentence +3. Cyphers that assign one letter/digit/symbol for one letter of the plain text are called MONOALPHABETIC CIPHERS. Below example:

PLAIN TEXT: "DIEGO"
SECRED TEXT: "GLHJS"

When it comes to Cesar's, the layout was always the same (+3). So someone who knew the idea could easily read the content. It would be much safer if we apply some changes, eg every even letter we shift +3 and every odd +5. But this would be also be harder to read for receiver. And now we get to the most difficult part of cryptography: HOW TO SAFELY DISTRIBUE A KEY? With this example you can easily understand that once captured key make cipher useless. And if its only between me and you - its fine. But if 10903490 soldiers is using it and we need to deliver new key to every unit it will take time, for a long time they will be using old one as they wont be aware about the change, and also new key could be captured and so on, so on...



-> CRYPTOANALISIS and the end of MONOALPHABETIC ciphers

Al-Kindi is known as the "father" of cryptoanalisis. He invented "chosen-plaintext attack". The idea goes like that:
	
	If you know the base language of the cipher (eg. German) you need to take a page long plain text in that language and count letters from the most to the least appearing. Then do the same with secret text. Then substitue correspondencies.
	
Of course this do not guarantee that you can already read the text, but having discover few letters, you may discover some words, then another, untill the message is not big deal anymore.

Nowadays this method will not work, because we use hash functions that give the same length output, no matter what is the length of the original message.



-> IMPORTANCE OF THE ABOVE
II Century BC, Greek Polybius (Polibusz) created a 5x5 table that for every letter assigned 2 numbers. "A" was 11, "B" was 12. Sounds farily simple. In 1st WW when Germans were outnumbering French. Their strategy was to concentrate a lot of soldiers in certain point and break the front line as far as they can to finally capture Paris. To succeed French had to know where enemy is going to strike, but at that particular time they had to keep a bit of soldiers on the long front line before attack happen. The way to predict was to listen to radio correspondency. Although they were capturing some informations, all of it looked like:
		
					XAXFX AGFDXXA DXGGX FAFFA XGAGX AVDFA GAXFX etc.
		
It took a very long while to understand those messages and as usuall with "unbreakable system" the human error came into play. There was a day when Germans sent a lot of messages, all using the same key. They were all compared and showed some repetitions, eg. that headder/beginning looks always the same (cipher-text only attack / frequency attack). With comparation of (chosen plain-text attack), code breaker was able to figure out the most often appearing letter in German that was 'e'. Few months later French were able to read the code. Untill soon Germans changed ADFGX to ADFGVX and the key itself (key - what letter is encrypted with what symbols), however the knowledge how the system works helped to decode it pretty quickly. French got to know where Germans were concentrating(remember - no GPS, not many planes, different times) and gather there to repell the attack. They succeed, later USA enter the game and free world won. 

Out of this story we can take few principals that are still important nowadays and we will discuss 'em later:
	-> Bad application of good system makes it not necesarly bad, but definitelly not as good as it is planned in theory.
	-> Usually its is human factor that is the weakest link. Even nowadays when we have all that difficult mathematical operation behind loging in to the bank, what will it do if you password is "1234abc" (dictionary-attack) or simply sticked to your monitor so anyone can get it?


/zdjecie tablicy/ 


-> FURTHER DEVELOPMENT OF CRYPTOGRAPHY
Since 1900 BC when we observed that Egyptian were doing some word-play to add more pathos when writing history of dead Pharaons, following 3500 years did not bring much on this field, from what already presented. Al-Kindi broke monoalphabetic cipher in IX AD but many people in Europe for a long time after believed its non-breakable. For few hundred years cryptography was rather treated as a intellectual entertainment than something of high importance.

It all changed when countries in Europe started emerging and diplomacy took place. Ambassadors, working also as spies, needed a way to securely send messages. Because monoalphabetic ciphers were not safe anymore, the new methods emerged. We reach the era of "unbreakable ciphers".

-> homophonic cipher
	every letter of plaintext can have many substitutes. The idea in medival times was to give for each letter as many substitutes as frequent is its % occurence in the language. Eg. if letter tend to appear 7% of times it would have 7 substitues. So:
						MIUEL can be EVOLA or EVOBA or any other.
	
	But frequency of appearance of single letters is not the only thing that distinguish the language. Letters come in pairs and threes, but also whole words repeat each other eg. "with", "but", "because". And those hints were good enough to break this code with time and humanity moved forward.
	

-> polyalphabetic cipher
	In the most simple words its many monoalphabetic ciphers used together. The first known example is "Alberti's Shield". It contains of two round shields that were put one inside another. The inside one could move, so there is now at least 25 possibilities to encrypt the message. Of course in order this to work, everyone had to have the shield and know the starting position.
	
				/// ZDJECIE TARCZY ALBERTIEGO ///
				
				
	The next one was invented 50 years later by Johannes Trithemius. He created a table with 26 alphabets, each starting from the next letter - so 1st is: ABC...Z 2nd is: BCD...A, last is: ZAB...Y. The idea was to take 1st letter and cypher it with 1st alphabet, 2nd with 2nd itd. That would protect the secred text from cipher-text only attack (frequency attack). However if someone knew the logic behind it, it was easy to break.
	
	
				/// TABULA RECTA I SZYFR VINEGRETA ///
				
	To prevent this, another half of the century later, Blaise de Vigenere proposed to change the order of secred alphabet. This way knowledge of how system work was not enough to decrypt the message. It was necessary to know the KEY. And the key could be a simple word known by both sides: eg. word "secret" would mean to use 19th alphabet to cipher 1st letter, 5th for 2nd, 3rd for 3rd etc. Vigenere also idea of "AUTOKEY". The receipient had to know only how to read the 1st letter that became the number to look for 2nd, then that 2nd became number to find 3rd etc. Vinaigrette cipher was broken only in XIX century, almost 300 years later by Charles Babbage. The most important here was to distinguish the length of the used key. This could be done by gathering enough secred texts (cipher-text only attack).
	

-> Diagraph Ciphers in short divided plaintext into pairs(diagrams) and then replace each pair with another pair of characters(disgrams), concerning some rules. The first in history diagraph cipher was called "Playfair" from the name the name of its inventor. The table was 5x5 and could be filled with key-word on the beginning. The following letters were in alfabetic order. 

				/// PLAYFAIR CYPHER ///
				

-> IIWW - ENIGMA
Enigma was a typewriter with bonus. In order to understand, try to imagine 2 typewriters coupled together with wires the way that when you press "a" on the 1st one, eg. key "f" is triggered on another one. This way we would get simple monoalphabetic cipher. Enigma itself was one typewriter with moving disks. The position of those disk decided what output one is going to get. The disks worked like car counter. When first one did full turn, 2nd one moved one position etc. The thing was that there were more disks than slots. Disks could have different sizes and contain not only letters. The final results depended on:
	. what disks were chosen
	. which one went first, second etc
	. what was starting position
If you considered that they are fixed and each one contain of 26 same symbols, then for 5 disks you would get 26^5 that gives close to 12 000 000 combinations.

For a receiver to decrypt the message, he had to know what disks and in what position were used. Germans had "daily keys" that were distributed every day via secure telegraph lines (now, secure means that nobody, at any place has physical access to it. Having physical access would mean that one can listen to the morse code being sent there. To make it secure, those strategic connections were build over hard to access terrain and also protected by patrols). Many times, on the beginning of the message there was another key repeated twice. The daily key was used to decrypt it, then someone was changing disks according to the new one and only then could read the final message. This yet made decryption harder because each message sent the same day could have different settings.

-> so if it was impossible, how they managed to break it?
There were few hints that were good to start with: on the beginning of each secret message there was a key repeated twice. Germans are also known for following the rules, so each message had the same shape and formalized character. Also the ability to decrypt message with the same one that encrypt text made it impossible to have plaintext letter being equal on secred text. This way scientists could search for some key words that almost sure had to appear like: attack (angriff). If any letter from word ANGRIFF would appear on the text, then we know it cannot be there and move to the next position. This is called negative pattern based cryptanalysis. So in general, the method behind breaking Enigma was to find probable words in secred text to later figure out the key basing on relation plaintext - secred text. 

			/// daj zdjcie 1.9 z stony 37 ///
			
			
-> NOWADAYS and the war about strong standards


When computers came to play we could "emulate" any physical device, and even more - we could virtually create ones that could not be constructed in real world. This means that all the physical limitations were gone. We still shift elements of the plaintext to get secred text, however now we do not encrypt letters, but 0s and 1s.


DES - Data Encryption Standard - was firstly intruced as "Demon" that was short from "Demonstration" with 128bit key. It was block cipher, that means it was encrypting blocs of data of certain length and giving as an output encrypted block of the same length.

128 bit was very hard to crack with bruteforce attack, however in USA, National Security Agency didnt want to agree on such a strong system. For a very long time they were weakening standards in order to have abiliti to access to data exchanged by potentially dangerous people. At certain point cryptography was treated as a weapon, what in practice meant that if you use key longer than given standard (for a long time it was 56bits) you may be arrested and sentenced to prison as you were illegally holding weapon. Many people who knew about cryptography and were not related with the government, were fighting agains NSA and against artificial lowering of the standard. Lower standards gave more control for the agency, but were also making regular users more vunerable agains hacker attacks. The whole situation had changed around 2000. Due to low standards investors could not trust companies in US and moved towards Europe where proper encryption was applied. Then to be competitive, they had changed law in US and although NSA still try to have controll, nowadays is not a crime to use world wide standards.

In 1976 DES was accepted, but with 56bit key. Every bit less reduce cipher security by 50%. So just imagine the difference between 128 and 56bits. DES was symmetric-key cryptography algorithm. This means that the same secret key is used both for encryption and decryption of the data. The sender and receiver of the data must both have access to the same key in order to communicate securely with each other. And this again created a problem - how to safely distribute a key? 


ASYMETRIC CRYPTOGRAPHY - RSA
Cryptographic system free from the problem of key distribution seemed impossible to achieve. Untill now the key to encrypt and decrypt had to be inaccessible. Ron (R)ivest, Adi (S)hamir and Leonarda (A)dleman similar to Whit Diffie and Marty Hellman (Diffie-Hellman) proposed that key used to encrypt should be given to the public access. They created the system with 2 keys - private and public. Public one could be distributed freely. Private one must be kept secret. Public key is used to encrypt the data that can be decrypted only with corresponding private key. Private key is used for decryption, but also can be used to decrypt message - this feature is known as "Digital Signature". Anyone with public key can decrypt the signature and knowing that it is impossible to create signature without having correct private key, its owner cant deny the signature. Theory was good, but mathematics were necessary to make it work.

// to chyba trzeba pominac

RSA and big prime numbers:
.To create public key first we need to multiplicate two big, randomly taken prime numbers [p, q] (and to give you idea: the biggest known prime number has 82,589,933 digits. The book I wrote has 600 000 characters and took around 200 pages A4, 414 book pages). Lets call that number "n". 

.Later we take number smaller than "n" that is relatively first number with (p -1) and (q -1). Let us call it "e".

.(n, e) is our public key that can be shared with everyone. 

The next step is to choose another big number with certain propertiest. It is encryption key (private key). Public key is created by multiplying private key and the multiplication of two big randomly taken prime numbers. Hence private key is easy to get if we know prime numbers used. Those numbers are known for the owner of the keys, however cryptoanalyst can get it only by factorization of that number. And that is not impossiblem however very hard to do, 

//




=======================
THEORY BEHIND CRYPTOGRAPHY:

Methods of breaking cipher texts:

-> Brute-force attack (łamanie metodą pełnego przeglądu)
This metods relies on trying many keys until the solution found makes sense. Performance depends on the computing power of the computer. The more keys/time we are able to try the bigger the chance to succeed. This is why it is important to use long key. If there is too many combinations avaliables brute-force attack stops being usefull.

-> Ciphertext-only attack (Łamanie z szyfrogramami)
Cryptanalyst has access only to cipher-texts created with the the same algorythm. Basing on them he must determine the key used to encrypt the message or or try to decrypt at least some part of the message. 

-> Known plain-text attack (łamanie ze znanym tekstem jawnym)
Cryptoanalyst knows some part of the cipher-text message, for example that it starts always from "Dear Sir" and ends with "Best Regards" and basing on this he is suppose to find a key/algorithm used to encrypt messages.

-> Chosen plain-text attack (łamanie z wybranym szyfrem jawnym)
In this case cryptoanalyst uses plain-text of his choise to encrypt it with the algorythm. In this case he can choose the plain-text to get more informations about the key. English used this method to break Enigma. They act in certain way to force Germans to send certain cipher-texts, that later on they caught. But this one is not only about history. This method is used nowadays against data bases. Attacker puts certain information to databses and compare cipher-texts. To put data into database is usually not difficult - anyone can register and fill shopping cart.

-> Chosen cipher-text attack (łamanie z wybranym szyfrogramem)
Attacker have access to ciphertext and corresponding plain-text and basing on it he needs to find authomatic decryption method. This is used agains systems with public key. Attacker can choose plain-text, get widely-avaliable public key and use it to encrypt the text. Then the attacker can use this info to figure out private key.


SOMETHING MORE ADVANCED:
Linear and Differential Cryptoanalysis.


OTHER METHODS more H4CK3RM4N
->DDoS



-> Replay Attack (atak przez powtorzenie)
Is about capturing a message sent to the server and using it later in time to get unauthorized access. For example hacker can get username and password, and use it to his advantage to get access to victims account. Other thing could be to obtain a packet containing data about electronic payment like credit card number, amount, date and later send it again to do unauthorized transaction.

To protect from it, random tokens, timestamps or nonces (one time values) are used inside the message. This way captured message is useless. 2FA is also good solution.


-> Dictionary Attack (atak słownikowy)
I think around 2008 when myspace was the most popular social media, somebody managed to break into their database and download millions (billions and billions :D) passwords of different users. At that time, they were all in plain text. From that moment on it became mandatory to use at least 8 different symbols everywhere when signing up. According to "darknet diaries" that huge list of passwords is kept in Kali Linux on default. But I also seen it when studying TCM academy. Its huge.

So dictionary attack is about using that database and just trying its entries one by one, counting that a victim has easy password that might be on the list.

It is important to notice that this attack can be also executed agains passwords that are hashed. Nowadays if you manage to obtain the database entries you gonna see only hash. However knowing the hashing algorytm, you can use dictionary and compare received hash. If they match job is done.



-> cryptoanalytic methods
-> linear and differential cryptanalysis
-> illegal methods of getting data access 0 h4ck3rm4n
